# FubaMarket2 Ubuntu Deployment Guide

–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é FubaMarket2 –Ω–∞ Ubuntu —Å–µ—Ä–≤–µ—Ä–µ —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ API URLs.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è Ubuntu

### 1. –û–±–Ω–æ–≤–∏—Ç–µ API URLs (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
```bash
# –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è Ubuntu
./convert_to_ubuntu.sh

# –ò—Å–ø—Ä–∞–≤—å—Ç–µ –≤—Å–µ –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ URL
./fix_all_urls_ubuntu.sh
```

### 2. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
# –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
sudo ./production_setup.sh
```

### 3. –£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo ./manage_services.sh status

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
sudo ./manage_services.sh restart
```

## üì¶ –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ

### üîß –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è Ubuntu
- **`convert_to_ubuntu.sh`** - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —Å macOS –Ω–∞ Ubuntu
- **`fix_all_urls_ubuntu.sh`** - –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ API URLs
- **`fix_urls_ubuntu.sh`** - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è URL

### üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- **`production_setup.sh`** - –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ production —Å–µ—Ä–≤–µ—Ä–∞
- **`setup_supervisor.sh`** - –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–ª—å–∫–æ Supervisor
- **`manage_services.sh`** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏ (start/stop/restart/logs)
- **`start_server.sh`** - –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –¥–ª—è development

### ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Supervisor
- **`fubamarket2-production.conf`** - Production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **`fubamarket2-django.conf`** - –¢–æ–ª—å–∫–æ Django —Å–µ—Ä–≤–∏—Å
- **`fubamarket2-nextjs.conf`** - –¢–æ–ª—å–∫–æ Next.js —Å–µ—Ä–≤–∏—Å
- **`fubamarket2.conf`** - Development –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### üîß API URL Configuration
- **`fubamarket/lib/api-config.ts`** - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ API endpoints
- **`env.production.example`** - –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è production
- **`fubamarket/env.local.example`** - –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è development

### üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **`DEPLOYMENT_CHECKLIST.md`** - –ü–æ–ª–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- **`API_URL_SETUP.md`** - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ API URLs
- **`SUPERVISOR_SETUP.md`** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- **`README_SUPERVISOR.md`** - –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Supervisor
- **`README_UBUNTU.md`** - –≠—Ç–æ—Ç —Ñ–∞–π–ª

## üéØ –ß—Ç–æ —Ä–µ—à–∞–µ—Ç —ç—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–í–∞—à –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ API URLs:
```typescript
// –ü–ª–æ—Ö–æ - –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
const response = await fetch('http://127.0.0.1:8000/api/products')
```

### ‚úÖ –†–µ—à–µ–Ω–∏–µ
–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ URLs:
```typescript
// –•–æ—Ä–æ—à–æ - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ
import API_ENDPOINTS from '@/lib/api-config'
const response = await fetch(API_ENDPOINTS.PRODUCTS)
```

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–í—Å–µ API endpoints –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `fubamarket/lib/api-config.ts`:
```typescript
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://127.0.0.1:8000'

export const API_ENDPOINTS = {
  PRODUCTS: `${API_BASE_URL}/api/products`,
  LOGIN: `${API_BASE_URL}/api/auth/login/`,
  // ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
}
```

### 2. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **Development**: `NEXT_PUBLIC_API_URL=http://127.0.0.1:8000`
- **Production**: `NEXT_PUBLIC_API_URL=https://your-domain.com`

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
–°–∫—Ä–∏–ø—Ç `fix_all_urls_ubuntu.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –î–æ–±–∞–≤–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç `API_ENDPOINTS` –≤–æ –≤—Å–µ —Ñ–∞–π–ª—ã
- –ó–∞–º–µ–Ω—è–µ—Ç –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ URL –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ
- –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –º–∞–ø–ø–∏–Ω–≥ endpoints

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- ‚úÖ `contexts/auth-context.tsx` - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ `hooks/use-product-filters.ts` - –§–∏–ª—å—Ç—Ä—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- ‚úÖ `components/featured-products.tsx` - –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
- ‚úÖ `components/latest-reviews.tsx` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã
- ‚úÖ `app/checkout/page.tsx` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
- ‚úÖ `app/admin/page.tsx` - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
- ‚úÖ `app/product/[id]/page.tsx` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–¥—É–∫—Ç–∞
- ‚úÖ –ò –µ—â–µ 20+ —Ñ–∞–π–ª–æ–≤...

### API Endpoints
- ‚úÖ Auth endpoints (login, register, profile)
- ‚úÖ Product endpoints (products, featured, by ID)
- ‚úÖ Order endpoints (orders, create)
- ‚úÖ Admin endpoints (dashboard, users, orders)
- ‚úÖ Vendor endpoints (products, orders, withdrawals)
- ‚úÖ Ops endpoints (orders, withdrawals)
- ‚úÖ Review endpoints (reviews, latest)

## üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ URL –æ–±–Ω–æ–≤–ª–µ–Ω—ã
grep -r "http://127.0.0.1:8000" fubamarket --include="*.tsx" --include="*.ts"
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–∫—Ä–æ–º–µ api-config.ts)
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏
```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
sudo ./manage_services.sh status

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
sudo ./manage_services.sh logs -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
sudo ./manage_services.sh restart
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
# Django –ª–æ–≥–∏
sudo tail -f /var/log/supervisor/fubamarket2-django-prod.log

# Next.js –ª–æ–≥–∏
sudo tail -f /var/log/supervisor/fubamarket2-nextjs-prod.log

# Nginx –ª–æ–≥–∏
sudo tail -f /var/log/nginx/error.log
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∫–ª—é—á–µ–Ω–æ –≤ production setup:
- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (Let's Encrypt)
- ‚úÖ Firewall (UFW)
- ‚úÖ Security headers –≤ Nginx
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- –û–±–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ email –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –í–∫–ª—é—á–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚úÖ Gunicorn —Å 3 –≤–æ—Ä–∫–µ—Ä–∞–º–∏ –¥–ª—è Django
- ‚úÖ Production build –¥–ª—è Next.js
- ‚úÖ Gzip —Å–∂–∞—Ç–∏–µ –≤ Nginx
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `sudo ./manage_services.sh logs`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `sudo ./manage_services.sh status`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã: `sudo ./manage_services.sh restart`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ URL –æ–±–Ω–æ–≤–ª–µ–Ω—ã

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx
sudo systemctl reload nginx

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å PostgreSQL
sudo systemctl status postgresql

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
sudo certbot certificates
```

## üîÑ Backup & Recovery

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å cron –∑–∞–¥–∞—á–∏
sudo crontab -l

# –†—É—á–Ω–æ–π –±—ç–∫–∞–ø
sudo /usr/local/bin/backup-fubamarket2.sh
```

### 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
sudo -u postgres psql fubamarket2 < /var/backups/fubamarket2/database_YYYYMMDD_HHMMSS.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
sudo tar -xzf /var/backups/fubamarket2/media_YYYYMMDD_HHMMSS.tar.gz -C /path/to/project/apps/api/
```

## ‚úÖ Final Verification

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Frontend –¥–æ—Å—Ç—É–ø–µ–Ω**: `https://your-domain.com`
2. **API —Ä–∞–±–æ—Ç–∞–µ—Ç**: `https://your-domain.com/api/products`
3. **Admin –ø–∞–Ω–µ–ª—å**: `https://your-domain.com/admin`
4. **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**: –ó–µ–ª–µ–Ω—ã–π –∑–∞–º–æ–∫ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
5. **–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã**: `sudo supervisorctl status`

## üéâ –ì–æ—Ç–æ–≤–æ!

–í–∞—à FubaMarket2 –ø—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! üöÄ

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:
- **Frontend**: `https://your-domain.com`
- **API**: `https://your-domain.com/api`
- **Admin**: `https://your-domain.com/admin`
- **Logs**: `/var/log/supervisor/`
- **Backups**: `/var/backups/fubamarket2/`

## üìã –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

```bash
# 1. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è Ubuntu
./convert_to_ubuntu.sh

# 2. –ò—Å–ø—Ä–∞–≤—å—Ç–µ API URLs
./fix_all_urls_ubuntu.sh

# 3. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
sudo ./production_setup.sh

# 4. –£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏
sudo ./manage_services.sh status
```

**–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ production –Ω–∞ Ubuntu!** üéâ
